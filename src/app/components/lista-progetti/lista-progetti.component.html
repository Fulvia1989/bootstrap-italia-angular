<div class=" d-inline-flex align-items-center justify-content-between mb-2" style="width: 100%;">
  <h2>Progetti</h2>
  <button class="btn btn-secondary ms-auto" type="button"
  (click)="goTo('/form-progetto')"
  [isAdmin]="(userRole | role)"
  [action]="'display-none'">
    Aggiungi Progetto
  </button>
</div>
<div class="table-responsive">
    <table class="table">
        <thead class="secondary-background">
          <tr>
            <th scope="col" class="col-1">#</th>
            <th scope="col" class="col-1">Programma</th>
            <th scope="col" class="col-2">Fondo</th>
            <th scope="col" class="col-1">Progetto</th>
            <th scope="col" class="col-2">Area Scientifica</th>
            <th scope="col" class="col-2">Output</th>
            <th scope="col" class="col-2">Finanziamento Ricevuto</th>
            <th scope="col" class="col-1">Azioni</th>
          </tr>
        </thead>
        <tbody>
            @for (progetto of (progetti | paginator:centerCurrentPage:pageElements); track $index) {

                <tr class="hover">
                  <th scope="row">
                    <button class="btn icon-button" type="button"
                      data-bs-toggle="collapse"
                      attr.data-bs-target="#{{progetto.codice}}"
                      aria-expanded="false"
                      attr.aria-controls="{{progetto.codice}}">
                      <it-icon name="chevron-right"></it-icon>
                  </button>

                  </th>
                  <td>{{progetto.programma}}</td>
                  <td>{{progetto.fondo}}</td>
                  <td>{{progetto.area}}</td>
                  <td>{{progetto.codice}}</td>
                  <td>{{progetto.output}}</td>
                  <td style="text-align: center;">{{progetto.finanziamento  |  currency:'EUR':'symbol':'4.2-2':'it-IT'}}</td>
                  <td>
                    <div class="buttons d-flex align-item-center justify-content-between">
                      <button type="button" class="btn btn-outline-secondary icon-button"
                      [isAdmin]="(userRole | role)"
                      [action]="'display-none'"
                      >
                        <it-icon size="sm" name="pencil"></it-icon>
                      </button>
                      <button type="button"  class="btn btn-outline-secondary icon-button "
                      (click)="goTo('/progetti/dettaglio-progetto',progetto.id)"
                      >
                        <it-icon size="sm" name="file-video"></it-icon>
                      </button>
                    </div>
                  </td>


                </tr>
                <tr class="hidden-row no-hover">

                  <td class="col-12" colspan="12">

                      <div class="collapse" id="{{progetto.codice}}">
                        @if(progetto.beneficiari.length){

                          <table class="table table-sm table-striped">
                              <thead>
                                <tr class="dark-background">
                                  <th class="col-12" colspan="12">Elenco Beneficiari</th>
                                </tr>
                                <tr>
                                  <th scope="col">Beneficiario</th>
                                  <th scope="col">Ruolo</th>
                                  <th scope="col">Email</th>
                                  <th scope="col">Telefono</th>
                                  <th scope="col">Contributo Realizzato</th>
                                </tr>
                              </thead>
                              <tbody>
                                @for (beneficiario of progetto.beneficiari; track $index) {
                                  <tr>
                                      <td>{{beneficiario.nome}}</td>
                                      <td>{{beneficiario.ruolo}}</td>
                                      <td>{{beneficiario.email}}</td>
                                      <td>{{beneficiario.telefono}}</td>
                                      <td>{{beneficiario.contributo}}</td>
                                  </tr>
                                }
                              </tbody>
                            </table>
                        }@else {

                          <div class="card card-body">
                            Lista vuota
                          </div>
                        }
                      </div>
                  </td>
                </tr>
            }


        </tbody>
      </table>
</div>
<it-pagination
[currentPage]="centerCurrentPage"
[visiblePages]="3"
[pageNumbers]="pagesNumber"
alignment="end"
(pageEvent)="rightPageChange($event)"></it-pagination>

<div class="it-example-modal">
  <div class="modal" tabindex="-1" role="dialog" id="myModal" aria-labelledby="modal2Title">
     <div class="modal-dialog" role="document">
        <div class="modal-content">
           <div class="modal-header">
              <h2 class="modal-title h5 " id="modal2Title">Questo Ã¨ un messaggio di notifica</h2>
              <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Chiudi finestra modale">
                 <svg class="icon"><use href="/bootstrap-italia/dist/svg/sprites.svg#it-close"></use></svg>
              </button>
           </div>
           <div class="modal-body">
              <p>In questo caso vengono forniti un pulsante di conferma e uno di chiusura della modale.</p>
           </div>
           <div class="modal-footer">
              <button class="btn btn-primary btn-sm" type="button">Ok</button>
           </div>
        </div>
     </div>
  </div>
</div>
